# Simulation Helper Scripts

The following scripts are used to parse the riscvOVPsim simulator output for use in gathering timing data.

# Instruction Histograms

The `histo_instrs.py` script takes a single argument, the `*.trace` file generated by the command in the [simulation framework example](https://github.com/dovedevic/blimp/tree/main/simulation). The output is a JSON file of the instruction histograms with the filename being `*.trace.histo` where the filename is identical to what was provided. The console output is a TSV (tab-separated-value) table of the same data for ease of copying into spreadsheet software.

For example, suppose we run the `hello_world.elf` defined in the [kernels](https://github.com/dovedevic/blimp/tree/main/benchmarks/kernels) directory. After running said benchmark with the command defined in the [simulation folder example](https://github.com/dovedevic/blimp/tree/main/simulation), we gather instruction histograms as follows:

```
$ /path/to/riscv-ovpsim/bin/Linux64/riscvOVPsim.exe  \
    --variant RV64GCV \
    --override riscvOVPsim/cpu/mips=2.000000e+02 \
    --override riscvOVPsim/cpu/mstatus_FS=1 \
    --override riscvOVPsim/cpu/vector_version=0.9 \
    --override riscvOVPsim/cpu/VLEN=8192 \
    --trace \
    --tracemem SA \
    --program hello_world.elf \
    | tee hello_world.trace


$ python3 histo_instrs.py hello_world.trace
addi    5
ecall   2
auipc   1
mv      1


$ cat hello_world.trace.histo
{
  "addi": 5,
  "ecall": 2,
  "auipc": 1,
  "mv": 1
}
```

# Memory Traces

The `memtrace_instrs.py` script takes a single argument,  the `*.trace` file generated by the command in the [simulation framework example](https://github.com/dovedevic/blimp/tree/main/simulation). The output is a DRAMsim2-compatible memory trace file named `*.trace.memtrace` where the filename is identical to what was provided. The console output is commented out but can be uncommented for getting the same output sent to the console.

Using the preceeding example, we use the script as follows:

```
$ python3 memtrace_instrs.py hello_world.trace
```

This output, `hello_world.trace.memtrace` is then sent through a DRAMsim2 trace-based simulation.
